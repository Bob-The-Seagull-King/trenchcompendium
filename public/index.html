<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
        <meta name="theme-color" content="#2a2a2a" />

        <link rel="icon" href="%PUBLIC_URL%/favicon/favicon.ico" />
        <link rel="icon" type="image/png" href="%PUBLIC_URL%/favicon/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="%PUBLIC_URL%/favicon/favicon-16x16.png" sizes="16x16" />
        <link rel="apple-touch-icon" href="%PUBLIC_URL%/favicon/apple-touch-icon.png" />

        <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />

         <link href="/static/css/main.c02abf55.css" rel="stylesheet">
         <title>Trench Companion | The officially supported Trench Crusade ressource</title>
         <meta name="description" content="The official resource for Trench Crusade" data-react-helmet="true">
         <meta property="og:description" content="The official resource for Trench Crusade" data-react-helmet="true">
         <meta property="og:title" content="Trench Companion | Trench Companion" data-react-helmet="true">
         <meta property="og:type" content="website" data-react-helmet="true">

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3744837400491966"
                crossorigin="anonymous"></script>

        <!-- Data‑Layer und gtag()-Wrapper -->
        <script>
            // dataLayer anlegen, bevor der Tag‑Manager geladen wird (Pflicht)
            window.dataLayer = window.dataLayer || [];
            function gtag(){ dataLayer.push(arguments); }

            // Consent‑Vorgabe: bis zur Nutzerentscheidung werden alle Zwecke verweigert
            gtag('consent', 'default', {
                ad_storage:        'denied',
                analytics_storage: 'denied',
                ad_user_data:      'denied',
                ad_personalization:'denied',
                wait_for_update:   500 // Tag‑Manager wartet max. 500 ms auf ein Update
            });

            // TCF‑Unterstützung für Google‑Tags aktivieren:contentReference[oaicite:2]{index=2}
            window['gtag_enable_tcf_support'] = true;
        </script>

        <!-- Funding Choices / AdSense CMP für EU Regeln -->
        <script async src="https://fundingchoicesmessages.google.com/i/pub-3744837400491966?ers=1"></script>
        <script>
            // Signalisieren, dass funding choices present ist.  Dieses Snippet stammt aus
            // den offiziellen AdSense‑Anweisungen.
            (function signalGooglefcPresent() {
                if (!window.frames['googlefcPresent']) {
                    if (document.body) {
                        var iframe = document.createElement('iframe');
                        iframe.style = 'width:0;height:0;border:none;z-index:-1000;left:-1000px;top:-1000px;display:none;';
                        iframe.name  = 'googlefcPresent';
                        document.body.appendChild(iframe);
                    } else {
                        setTimeout(signalGooglefcPresent, 0);
                    }
                }
            })();
        </script>

        <script>
            // Consent‑Callback registrieren
            window.googlefc = window.googlefc || {};
            googlefc.callbackQueue = googlefc.callbackQueue || [];

            googlefc.callbackQueue.push({
                CONSENT_MODE_DATA_READY: function () {
                    // Aktuelle Consent‑Werte aus Funding Choices abrufen
                    var status = googlefc.getGoogleConsentModeValues();
                    var ConsentEnum = googlefc.ConsentModePurposeStatusEnum;

                    // Helper zur Umwandlung in 'granted'/'denied'
                    function mapStatus(value) {
                        return value === ConsentEnum.CONSENT_MODE_PURPOSE_STATUS_GRANTED ? 'granted' : 'denied';
                    }

                    // Neue Consent‑Einstellungen anhand der vier Zwecke
                    var consentUpdate = {
                        ad_storage:         mapStatus(status.adStoragePurposeConsentStatus),
                        analytics_storage:  mapStatus(status.analyticsStoragePurposeConsentStatus),
                        ad_user_data:       mapStatus(status.adUserDataPurposeConsentStatus),
                        ad_personalization: mapStatus(status.adPersonalizationPurposeConsentStatus)
                    };

                    // Consent‑Update an gtag senden
                    gtag('consent','update', consentUpdate);

                    // Jetzt erst den Google Tag Manager laden
                    var gtmScript = document.createElement('script');
                    gtmScript.async = true;
                    gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-NFVT7W7X';
                    document.head.appendChild(gtmScript);
                }
            });
        </script>

        <script>
            console.log('1.4');
        </script>

    </head>

    <body class="trench-companion">
        <!-- GTM Fallback -->
        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NFVT7W7X"
                    height="0" width="0" style="display:none;visibility:hidden"></iframe>
        </noscript>

        </noscript>
         <noscript>You need to enable JavaScript to run this app.</noscript>
         <style>#global-loader{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#2a2a2a;z-index:9999}.spinner{width:48px;height:48px;border:4px solid rgba(135,18,20,.5);border-top:4px solid #d01317;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}</style>
         <style>
            #global-loader {
                position: fixed;
                inset: 0;
                display: flex;
                align-items: center;
                justify-content: center;
                background: #2a2a2a;
                z-index: 9999;
            }

            .spinner {
                width: 48px;
                height: 48px;
                border: 4px solid rgba(135,18,20,0.5);
                border-top: 4px solid #d01317;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }
         </style>
         <div id="global-loader">
            <div class="spinner"></div>
         </div>

         <div id="root"></div>
    </body>
</html>
